(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4634:(e,t,r)=>{Promise.resolve().then(r.bind(r,9875))},9875:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>w});var a=r(5155),s=r(3562),i=r(5565),n=r(2115),c=r(747),o=r(4247),l=r(1),d=r(591),m=r(4259);class u{static async getBrowserFingerprint(){let e=await m.Ay.load();return(await e.get()).visitorId}static async getIpAddress(){try{let e=await fetch("https://api.ipify.org?format=json");return(await e.json()).ip}catch(e){return console.error("Error getting IP address:",e),"unknown"}}static isIncognitoMode(){let e=(()=>{try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch(e){return!1}})(),t=(()=>{try{return!!window.indexedDB}catch(e){return!1}})();return!e||!t}static async submitVote(e){try{let t=this.isIncognitoMode();if(t)return{success:!1,message:"لا يمكن التصويت في وضع التصفح المتخفي. يرجى استخدام وضع التصفح العادي",error:"INCOGNITO_MODE"};let[r,a]=await Promise.all([this.getBrowserFingerprint(),this.getIpAddress()]),{data:s,error:i}=await c.N.from("voter_verifications").select("id").eq("browser_fingerprint",r).maybeSingle();if(i)return console.error("Error checking verification:",i),{success:!1,message:"حدث خطأ أثناء التحقق من التصويت",error:"VERIFICATION_ERROR"};if(s)return{success:!1,message:"لقد قمت بالتصويت مسبقاً",error:"DUPLICATE_VOTE"};let n={user_profile_id:e.voterProfileId,ip_address:a,browser_fingerprint:r,is_incognito:t,user_agent:navigator.userAgent},{data:o,error:l}=await c.N.from("voter_verifications").insert([n]).select().single();if(l)return console.error("Error creating verification:",l),{success:!1,message:"حدث خطأ أثناء إنشاء التحقق",error:"VERIFICATION_CREATE_ERROR"};if(!o)return{success:!1,message:"فشل في إنشاء سجل التحقق",error:"NO_VERIFICATION_CREATED"};let d={participant_id:e.participantId,voter_profile_id:e.voterProfileId,verification_id:o.id,status:"verified"},{error:m}=await c.N.from("votes").insert([d]);if(m)return console.error("Error submitting vote:",m),{success:!1,message:"حدث خطأ أثناء تسجيل التصويت",error:"VOTE_SUBMISSION_ERROR"};let{error:u}=await c.N.from("participants").update({votes_count:c.N.rpc("increment")}).eq("id",e.participantId);return u&&console.error("Error updating vote count:",u),{success:!0,message:"تم تسجيل تصويتك بنجاح!"}}catch(e){return console.error("Vote submission error:",e),{success:!1,message:"حدث خطأ أثناء التصويت",error:e instanceof Error?e.message:"Unknown error"}}}static async getParticipantsByCategory(e){let{data:t,error:r}=await c.N.from("participants").select("*").eq("category_id",e).order("votes_count",{ascending:!1});if(r)throw r;return t}static async getVotingStats(){let{data:e,error:t}=await c.N.from("participants").select("id, name, votes_count, category_id").order("votes_count",{ascending:!1});if(t)throw t;if(!e)return{totalVotes:0,leaders:[],dailyGrowth:0};let r=e.reduce((e,t)=>e+(t.votes_count||0),0),a=e.slice(0,3).map(e=>({name:e.name,votes:e.votes_count||0,percent:r>0?Math.round((e.votes_count||0)/r*100):0}));return{totalVotes:r,leaders:a,dailyGrowth:0}}}var p=r(3463),x=r(9795);function g(e){let{id:t,name:r,title:c,imageUrl:m,votes:g,className:h}=e,[f,y]=(0,n.useState)(!1),[b,v]=(0,n.useState)(null),[N,j]=(0,n.useState)(!1),w=async()=>{y(!0),v(null);try{let e="temp_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),r=await u.submitVote({participantId:t,voterProfileId:e});if(!r.success)throw Error(r.message);j(!0),setTimeout(()=>{j(!1)},3e3)}catch(e){v(e instanceof Error?e.message:"حدث خطأ غير متوقع")}finally{y(!1)}};return(0,a.jsx)("div",{className:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,x.QP)((0,p.$)(t))}("relative bg-gray-800/50 rounded-xl overflow-hidden backdrop-blur-sm border border-white/10",h),children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("div",{className:"relative w-full aspect-square rounded-lg overflow-hidden mb-4",children:(0,a.jsx)(i.default,{src:m,alt:r,fill:!0,className:"object-cover"})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-white mb-1 font-arabic",children:r}),(0,a.jsx)("p",{className:"text-gray-400 text-sm font-arabic",children:c})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(s.P.button,{onClick:w,whileHover:{scale:1.02},whileTap:{scale:.98},disabled:f,className:"w-full py-2 bg-primary/20 hover:bg-primary/30 rounded-lg text-primary font-arabic flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:f?(0,a.jsx)(l.A,{className:"w-5 h-5 animate-spin"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"صوت الآن"})]})})}),(0,a.jsxs)(o.N,{mode:"wait",children:[b&&(0,a.jsx)(s.P.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"mt-2 text-red-400 text-sm text-center font-arabic",children:b}),N&&(0,a.jsx)(s.P.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"mt-2 text-green-400 text-sm text-center font-arabic",children:"تم تسجيل تصويتك بنجاح!"})]})]})})}let h={creators:"المبدعون - Creators",sports:"الرياضيون - Sports",organizations:"المنظمات - Organizations"},f=["creators","sports","organizations"],y=e=>{let{participant:t,index:r,categoryIndex:s}=e,[i,c]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{c(!0)},[]),i?(0,a.jsx)(g,{id:t.id,name:t.name,title:h[t.category_id]||t.category_id,imageUrl:t.image,votes:t.votes_count}):null},b=()=>(0,a.jsx)("div",{className:"container mx-auto px-4",children:(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[...Array(12)].map((e,t)=>(0,a.jsxs)("div",{className:"bg-gray-800/30 backdrop-blur-sm rounded-lg p-4 border border-gray-700/30",children:[(0,a.jsx)("div",{className:"aspect-square bg-gray-700/30 rounded-lg mb-4"}),(0,a.jsx)("div",{className:"h-4 bg-gray-700/30 rounded w-3/4 mx-auto"})]},t))})}),v=e=>{let{name:t}=e;return(0,a.jsxs)("div",{className:"relative py-6",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-center font-arabic bg-clip-text text-transparent bg-gradient-to-r from-gray-100 to-gray-300",children:t}),(0,a.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-0 w-24 h-1 rounded-full bg-gradient-to-r from-primary/50 to-primary-light/50"})]})};function N(){let[e,t]=(0,n.useState)({}),[r,s]=(0,n.useState)(!0),[i,o]=(0,n.useState)(null),[l,d]=(0,n.useState)(!1);if((0,n.useEffect)(()=>{d(!0),async function(){try{let{data:e,error:r}=await c.N.from("participants").select("\n            id,\n            name,\n            image,\n            category_id,\n            votes_count,\n            is_active\n          ").eq("is_active",!0).order("name");if(r)throw console.error("Supabase error:",r),r;if(!e||0===e.length){o("لم يتم العثور على مشاركين");return}let a=e.reduce((e,t)=>{let r=t.category_id,a=h[r]||r;return e[r]||(e[r]={name:a,participants:[]}),e[r].participants.push(t),e},{});t(a),o(null)}catch(e){console.error("Error loading participants:",e),o("فشل في تحميل المشاركين")}finally{s(!1)}}()},[]),!l||r)return(0,a.jsx)(b,{});if(i)return(0,a.jsx)("div",{className:"container mx-auto px-4",children:(0,a.jsx)("div",{className:"bg-red-500/10 backdrop-blur-sm border border-red-500/20 rounded-lg p-4",children:(0,a.jsx)("p",{className:"text-red-400 text-center font-arabic",children:i})})});let m=Object.entries(e).sort((e,t)=>{let[r]=e,[a]=t;return f.indexOf(r)-f.indexOf(a)});return(0,a.jsx)("div",{className:"container mx-auto px-4",children:(0,a.jsx)("div",{className:"space-y-24",children:m.map((e,t)=>{let[r,s]=e;return(0,a.jsxs)("div",{className:"space-y-12",children:[(0,a.jsx)(v,{name:s.name}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8",children:s.participants.map((e,r)=>(0,a.jsx)(y,{participant:e,index:r,categoryIndex:t},e.id))})]},r)})})})}var j=r(7734);function w(){return(0,a.jsxs)("div",{className:"min-h-screen bg-[#0a0f1c] relative",children:[(0,a.jsxs)("div",{className:"fixed inset-0 pointer-events-none z-0",children:[(0,a.jsx)(s.P.div,{initial:{opacity:0},animate:{opacity:.3},className:"absolute top-0 -right-4 w-72 h-72 bg-primary/30 rounded-full mix-blend-multiply filter blur-xl animate-blob"}),(0,a.jsx)(s.P.div,{initial:{opacity:0},animate:{opacity:.3},transition:{delay:.2},className:"absolute top-0 -left-4 w-72 h-72 bg-secondary/30 rounded-full mix-blend-multiply filter blur-xl animate-blob animation-delay-2000"}),(0,a.jsx)(s.P.div,{initial:{opacity:0},animate:{opacity:.3},transition:{delay:.4},className:"absolute -bottom-8 right-20 w-72 h-72 bg-accent/30 rounded-full mix-blend-multiply filter blur-xl animate-blob animation-delay-4000"})]}),(0,a.jsx)("div",{className:"relative z-10 min-h-screen",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)(s.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"w-full flex justify-center mb-8",children:(0,a.jsx)("div",{className:"relative w-48 h-24 md:w-64 md:h-32",children:(0,a.jsx)(i.default,{src:"/images/nadevoGroup.png",alt:"مجموعة نادِفو",width:256,height:128,priority:!0,className:"object-contain"})})}),(0,a.jsx)(s.P.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-4xl font-bold text-white mb-12 text-center font-arabic",children:"من يستحق جائزة التميز؟ صوت الآن"}),(0,a.jsx)("div",{className:"mb-16",children:(0,a.jsx)(j.A,{})}),(0,a.jsx)(N,{})]})})]})}},7734:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var a=r(5155),s=r(2115),i=r(3562),n=r(747),c=r(6644),o=r(6878),l=r(2823);function d(){let[e,t]=(0,s.useState)(null),[r,d]=(0,s.useState)(!0),[m,u]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{u(!0)},[]),(0,s.useEffect)(()=>{async function e(){try{let{count:e,error:r}=await n.N.from("votes").select("*",{count:"exact",head:!0});if(r)throw r;t(e||0)}catch(e){console.error("Error fetching votes:",e)}finally{d(!1)}}if(m){e();let t=n.N.channel("votes_counter").on("postgres_changes",{event:"*",schema:"public",table:"votes"},()=>e()).subscribe();return()=>{t.unsubscribe()}}},[m]),m)?(0,a.jsx)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md mx-auto",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/10 to-secondary/10 rounded-2xl backdrop-blur-xl border border-white/10"}),(0,a.jsxs)("div",{className:"relative p-6 rounded-2xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 rtl:space-x-reverse",children:[(0,a.jsx)(c.A,{className:"w-6 h-6 text-primary"}),(0,a.jsx)("h3",{className:"text-lg font-bold text-white font-arabic",children:"عدد المصوّتين"})]}),(0,a.jsx)(o.A,{className:"w-5 h-5 text-green-400"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 rtl:space-x-reverse",children:[(0,a.jsx)(l.A,{className:"w-5 h-5 text-gray-400"}),(0,a.jsx)("span",{className:"text-gray-400 font-arabic",children:"صوت"})]}),(0,a.jsx)(i.P.div,{initial:{scale:1.2,opacity:0},animate:{scale:1,opacity:1},className:"text-4xl font-bold text-green-400 font-arabic",children:r?(0,a.jsx)("div",{className:"h-8 w-24 bg-gray-700 rounded animate-pulse"}):(null==e?void 0:e.toLocaleString("en-US"))||"0"},e)]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:(0,a.jsx)(i.P.div,{className:"h-full bg-gradient-to-r from-primary to-secondary",initial:{width:0},animate:{width:"100%"},transition:{duration:2,ease:"easeOut"}})})})]})]})}):null}},747:(e,t,r)=>{"use strict";r.d(t,{N:()=>n});var a=r(5974);let s="https://kuihgcfcpfllnrxtnovv.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt1aWhnY2ZjcGZsbG5yeHRub3Z2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgyOTc3NDksImV4cCI6MjA1Mzg3Mzc0OX0.l7N7riqqdc7hFRyolzsrJ2Q2JzQhUUR-jlOdi4PYtz8",n=(()=>{if(!s||!i)throw Error("Missing environment variables: NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY must be defined");return(0,a.UU)(s,i,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},db:{schema:"public"},global:{headers:{"x-client-info":"voting-system"}}})})()}},e=>{var t=t=>e(e.s=t);e.O(0,[736,884,379,441,517,358],()=>t(4634)),_N_E=e.O()}]);